name: Commit Message Check

on:
  pull_request:
    branches: [main]

jobs:
  check-commit-messages:
    name: Validate Commit Messages
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Check commit messages
        run: |
          echo "Checking commit messages for sensitive keywords..."

          SENSITIVE_KEYWORDS=(
            "trademark"
            "Class 9"
            "Class 42"
            "USPTO"
            "positioning"
            "competitive"
            "entity confusion"
          )

          COMMITS=$(git log --format=%B origin/main..HEAD)

          for keyword in "${SENSITIVE_KEYWORDS[@]}"; do
            if echo "$COMMITS" | grep -iq "$keyword"; then
              echo "❌ Found sensitive keyword in commit messages: $keyword"
              echo "Please use generic technical language in public commits"
              exit 1
            fi
          done

          echo "✅ Commit messages are clean"
